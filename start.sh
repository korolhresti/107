#!/bin/bash

# Цей скрипт виконується при кожному запуску/перезапуску сервісу на Render

echo "Застосування схеми до бази даних..."
# Застосовуємо схему. Прапорець -X запобігає виводу зайвих повідомлень.
# Команда виконається успішно, навіть якщо таблиці вже існують, завдяки "IF NOT EXISTS" у вашому .sql файлі.
# Це також додасть відсутні стовпці до існуючих таблиць.
psql $DATABASE_URL -f schema.sql -X

echo "Запуск веб-сервера Uvicorn..."
# Запускаємо веб-сервер на порту, який надає Render (зазвичай 10000)
uvicorn bot:app --host 0.0.0.0 --port ${PORT:-10000}
